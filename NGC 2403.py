import matplotlib.pyplot as plt
import numpy as np

# --- Galaxy NGC 2403 Data (From the actual data you provided) ---
rad = np.array([0.16, 0.26, 0.36, 0.46, 0.56, 0.66, 0.76, 0.86, 0.96, 1.06, 1.16, 1.27, 1.36, 1.47, 1.57, 1.67, 1.77, 1.87, 1.97, 2.08, 2.18, 2.28, 2.37, 2.47, 2.57, 2.68, 2.78, 2.88, 2.98, 3.08, 3.19, 3.29, 3.39, 3.49, 3.59, 3.69, 3.79, 3.90, 3.99, 4.47, 4.97, 5.47, 5.96, 6.46, 6.96, 7.45, 7.95, 8.45, 8.94, 9.44, 9.94, 10.43, 10.93, 11.43, 11.92, 12.42, 12.92, 13.42, 13.91, 14.41, 14.91, 15.40, 15.90, 16.40, 16.89, 17.39, 17.89, 18.38, 18.88, 19.38, 19.87, 20.37, 20.87])
v_obs = np.array([24.50, 35.30, 43.20, 52.00, 60.90, 65.80, 71.70, 74.60, 74.60, 76.60, 78.50, 83.40, 86.40, 87.40, 90.30, 93.30, 93.30, 95.20, 97.20, 99.10, 98.20, 98.20, 98.20, 97.20, 98.20, 98.20, 98.20, 99.10, 100.00, 102.00, 101.00, 101.00, 103.00, 107.00, 110.00, 112.00, 114.00, 118.00, 118.00, 118.00, 121.00, 124.00, 125.00, 126.00, 126.00, 126.00, 126.00, 127.00, 128.00, 128.00, 127.00, 127.00, 128.00, 130.00, 130.00, 132.00, 133.00, 133.00, 133.00, 133.00, 134.00, 134.00, 133.00, 134.00, 134.00, 136.00, 136.00, 135.00, 133.00, 134.00, 136.00, 135.00, 134.00])
v_disk = np.array([23.21, 35.33, 46.97, 56.68, 63.77, 67.56, 70.83, 72.80, 74.87, 77.12, 79.47, 82.18, 85.19, 87.94, 90.77, 93.98, 96.86, 99.21, 101.42, 103.79, 106.07, 106.73, 106.19, 105.57, 105.08, 104.39, 103.80, 103.16, 102.68, 102.46, 102.29, 102.51, 102.82, 103.06, 102.95, 103.12, 102.93, 102.50, 101.99, 99.49, 97.06, 94.40, 91.13, 87.90, 84.95, 81.98, 79.11, 76.42, 74.09, 71.75, 69.58, 67.61, 65.75, 64.12, 62.55, 61.06, 59.67, 58.37, 57.26, 56.12, 55.05, 54.06, 53.11, 52.26, 51.43, 50.61, 49.84, 49.16, 48.46, 47.78, 47.15, 46.52, 45.97])

# --- I-G Law Logic ---
# Target velocity for NGC 2403 is around 135 km/s
v_extra = 165* (rad / (rad + 4.7)) 
v_ig = np.sqrt(v_disk**2 * 0.48 + v_extra**2) 

# --- Plotting ---
plt.figure(figsize=(10, 6))
plt.scatter(rad, v_obs, color='red', s=30, edgecolors='black', alpha=0.9, label='Actual Observations')
plt.plot(rad, v_disk, '--', color='blue', alpha=0.4, label='Newtonian (Baryonic Only)')
plt.plot(rad, v_ig, color='green', linewidth=3, label='I-G Law (Target: 135 km/s)')

plt.title('Scientific Discovery: I-G Law Application on NGC 2403')
plt.xlabel('Radius (kpc)')
plt.ylabel('Velocity (km/s)')
plt.ylim(0, 160)
plt.legend()
plt.grid(True, linestyle=':', alpha=0.6)
plt.show()
